apiVersion: integreatly.org/v1alpha1
kind: GrafanaDataSource
metadata:
  name: loki-{{ clusterName }}-{{ loki_tenant_id }}
  namespace: {{ infra_monitoring_namespace }}
spec:
  datasources:
    - access: proxy
      editable: true
      jsonData:
        httpHeaderName1: X-Scope-OrgID
        httpHeaderName2: Authorization
        tlsAuthWithCACert: true
      name: Loki-{{ clusterName }}-{{ loki_tenant_id }}
      secureJsonData:
        httpHeaderValue1: {{ loki_tenant_id }}
        httpHeaderValue2: >-
          Bearer {{ loki_gateway_token }}
        tlsCACert: |
          {{ loki_gateway_ca_cert }}
      type: loki
      url: >-
        {{ loki_gateway_route_url }}:443/api/logs/v1/{{ loki_tenant_id }}
  name: loki.yaml
