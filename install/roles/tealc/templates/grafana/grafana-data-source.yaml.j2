apiVersion: integreatly.org/v1alpha1
kind: GrafanaDataSource
metadata:
  name: {{ target.name }}-source
  labels:
    project: "tealc"
    managed: "true"
  annotations:
    # Exclude from ArgoCD sync
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    argocd.argoproj.io/sync-options: Prune=false
    argocd.argoproj.io/hook: Skip
spec:
  name: middleware.yaml
  datasources:
    - name: {{ target.name }}
      type: prometheus
      access: proxy
      # url: https://thanos-querier.openshift-monitoring.svc.cluster.local:9091
      url: {{ target.url }}
      basicAuth: false
      basicAuthUser: internal
      isDefault: false
      version: 1
      editable: true
      jsonData:
        tlsSkipVerify: true
        timeInterval: "5s"
        httpHeaderName1: "Authorization"
      secureJsonData:
        httpHeaderValue1: "Bearer {{ access_token }}"
